public void save(LogEntity logEntity, String schemaName, String tableName) {
    EntityManager entityManager = entityManagerProvider.getEntityManager();
    EntityTransaction transaction = entityManager.getTransaction();

    try {
        transaction.begin();
        
        String sql = String.format(
            "INSERT INTO %s.%s (timestamp, type, payload, status, headers) VALUES (?, ?, ?, ?, ?)",
            schemaName, tableName
        );

        Query query = entityManager.createNativeQuery(sql);
        query.setParameter(1, logEntity.getTimestamp());
        query.setParameter(2, logEntity.getType());
        query.setParameter(3, logEntity.getPayload());
        query.setParameter(4, logEntity.getStatus());
        query.setParameter(5, logEntity.getHeaders());

        query.executeUpdate();
        transaction.commit();
    } catch (Exception e) {
        if (transaction.isActive()) {
            transaction.rollback();
        }
        throw e;
    } finally {
        entityManager.close();
    }
}
