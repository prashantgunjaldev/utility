import static org.junit.jupiter.api.Assertions.*;
import org.junit.jupiter.api.Test;
import java.time.LocalDateTime;
import java.util.UUID;

class PsrRequestHelperTest {

    private final PsrRequestHelper helper = new PsrRequestHelper();

    @Test
    void testBuildPsrRequestLogDTO() {
        // Arrange
        String expectedStatus = "COMPLETED";

        PsrRequestLogDTO inputDto = new PsrRequestLogDTO();
        inputDto.setDL("DownloadLogic");
        inputDto.setAcqRequestId("Acq123");
        inputDto.setRequestedby("tester");
        inputDto.setBbgRequestId("Bbg456");

        // Act
        PsrRequestLogDTO result = helper.buildPsrRequestLogDTO(expectedStatus, inputDto);

        // Assert
        assertNotNull(result, "Resulting DTO should not be null");

        assertNotNull(result.getId(), "ID should not be null");
        // UUID substring starting from index 9 should have length 32 - 9 = 23
        // Actually UUID.toString() length is 36, substring(9) length = 27
        assertEquals(UUID.randomUUID().toString().length() - 9, result.getId().length(),
            "ID length should be UUID substring starting at index 9");

        assertEquals(expectedStatus, result.getStatus(), "Status should match input status");
        assertNotNull(result.getCreatedAt(), "createdAt should be set");

        assertEquals(inputDto.getDL(), result.getDL(), "DL field should be copied");
        assertEquals(inputDto.getAcqRequestId(), result.getAcqRequestId(), "AcqRequestId should be copied");
        assertEquals(inputDto.getRequestedby(), result.getRequestedby(), "Requestedby should be copied");
        assertEquals(inputDto.getBbgRequestId(), result.getBbgRequestId(), "BbgRequestId should be copied");
    }
}
